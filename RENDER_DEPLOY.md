# 🎨 Render 部署指南

Render 是一个简单的云平台，完全支持 Docker，有免费额度，适合新手快速部署。

---

## 📊 Render vs 其他平台

| 特性 | Render | Fly.io | Railway | 云服务器 |
|------|--------|---------|---------|---------|
| **免费额度** | ✅ 有限 | ✅ 更多 | ✅ $5/月 | ❌ 无 |
| **不会休眠** | ❌ 会休眠 | ✅ 是 | ❌ 会 | ✅ 是 |
| **需要信用卡** | ❌ 否 | ✅ 是 | ❌ 否 | ❌ 否 |
| **配置难度** | ⭐⭐ | ⭐⭐⭐⭐ | ⭐⭐ | ⭐⭐⭐ |
| **构建速度** | ⭐⭐ | ⭐⭐⭐⭐ | ⭐⭐⭐ | ⭐⭐⭐⭐ |
| **新手友好** | ✅ 很好 | ⭐ 一般 | ✅ 很好 | ⭐ 需要学习 |

---

## 💰 费用说明

### 免费额度

- **Web Services**：
  - 750 小时/月（约31天）
  - 512MB RAM
  - 0.1 CPU
  - 断续运行（15分钟无请求会休眠）

- **限制**：
  - ❌ 15分钟无活动自动休眠
  - ❌ 休眠后首次请求需要等待30-60秒启动
  - ❌ 免费版每月最多重启 15 次

### 付费计划

| 计划 | 费用 | 配置 |
|------|------|------|
| **Starter** | $7/月 | 512MB RAM, 0.5 CPU, 不休眠 |
| **Standard** | $25/月 | 2GB RAM, 1 CPU, 不休眠 |
| **Pro** | $85/月 | 8GB RAM, 4 CPU, 不休眠 |

**预估月费用：**
- 免费版：$0（但会休眠）
- 付费版：$7-25/月（不休眠）

---

## 🚀 部署步骤

### 步骤 1：注册 Render 账号

1. 访问 https://dashboard.render.com/
2. 点击 **"Sign Up"**
3. 使用 **GitHub 账号**登录（推荐）
   或使用邮箱注册
4. 授权 Render 访问你的 GitHub

**不需要信用卡！** ✅

### 步骤 2：创建新的 Web Service

1. 登录后，点击 **"New +"** 按钮
2. 选择 **"Web Service"**

### 步骤 3：连接 GitHub 仓库

1. 在 "Connect a repository" 部分
2. 搜索 `maibot-my-fork`
3. 点击 **"Connect"** 连接仓库

如果看不到仓库：
- 点击 "Configure account" 授权
- 确保仓库是 Public 或已授权 Render 访问

### 步骤 4：配置部署设置

**Basic 设置：**

```
Name: maibot-core
Region: Singapore (或离你最近的区域)
Branch: main
```

**Runtime 设置：**

```
Runtime: Docker
Dockerfile Path: ./Dockerfile
Docker Context: ./
```

**Environment 设置：**

选择 **"Docker"** 作为环境。

### 步骤 5：配置环境变量

滚动到 **"Environment Variables"** 部分，添加：

| Key | Value | Required |
|-----|-------|----------|
| `API_KEY` | `sk-你的DeepSeek密钥` | ✅ 必需 |
| `MODEL_NAME` | `deepseek-chat` | ✅ 必需 |
| `SUPERUSERS` | `你的QQ号` | ✅ 必需 |
| `NICKNAME` | `麦麦` | 可选 |
| `EULA_AGREE` | `1b662741904d7155d1ce1c00b3530d0d` | ✅ 必需 |
| `PRIVACY_AGREE` | `9943b855e72199d0f5016ea39052f1b6` | ✅ 必需 |
| `TZ` | `Asia/Shanghai` | 可选 |
| `HOST` | `0.0.0.0` | 可选 |
| `PORT` | `22400` | 可选 |

### 步骤 6：高级配置（可选）

**Health Check（健康检查）：**

```
Path: /health
Check interval: 30s
Timeout: 10s
```

**如果需要不休眠：**
- 需要升级到付费计划（$7/月起）
- 或设置定时 ping（不推荐，不稳定）

### 步骤 7：部署

1. 点击 **"Create Web Service"**
2. 等待构建和部署（约 5-10 分钟）
3. 看到 "Live" 状态表示成功

### 步骤 8：查看日志

1. 在服务页面，点击 **"Logs"** 标签
2. 查看实时日志
3. 找到登录二维码信息

### 步骤 9：扫码登录

在日志中找到二维码，用手机 QQ 扫码登录。

---

## 🔧 管理和监控

### 查看日志

```
在 Render 控制台：
1. 点击服务名称
2. 点击 "Logs" 标签
3. 实时查看日志输出
```

### 重启服务

```
方法1：手动重启
1. 点击服务名称
2. 点击 "Manual Deploy"
3. 选择分支，点击 "Deploy"

方法2：自动重启
- 推送代码到 GitHub
- Render 会自动重新部署
```

### 查看指标

```
在服务页面：
- "Metrics" 标签
- 可以查看：
  - CPU 使用率
  - 内存使用量
  - 响应时间
  - 请求次数
```

### 更新环境变量

```
1. 点击服务名称
2. 点击 "Environment" 标签
3. 修改或添加变量
4. 点击 "Save Changes"
5. 服务会自动重启
```

---

## ⚠️ 重要限制

### 1. 自动休眠问题

```
免费版限制：
✗ 15分钟无活动 = 自动休眠
✗ 休眠后需要 30-60秒 启动
✗ 这意味着：

场景：晚上没人用
22:00 → 最后一次聊天
22:15 → 机器人休眠 ❌
07:00 → 早上有人发消息
07:01 → 机器人还在启动中 ⏳
07:02 → 机器人才回复（晚了1分钟）

影响：
❌ 体验不好
❌ 可能错过消息
❌ QQ 可能掉线
```

**解决方案：**
- 方案 A：升级到付费计划（$7/月，不休眠）
- 方案 B：设置定时 ping（复杂，不稳定）
- 方案 C：接受休眠（适合测试）

### 2. MaiBot 多容器问题

**Render 不支持 docker-compose**

MaiBot 需要：
- Core 服务（AI核心）✅ 可以部署
- NapCat 服务（QQ协议）❌ 无法部署

**这意味着：**
```
架构：
Render 云端          你的电脑/服务器
┌─────────────┐      ┌──────────────┐
│   Core      │      │   NapCat     │
│   (AI)      │←────→│   (QQ)       │
└─────────────┘      └──────────────┘

需要：
1. 在 Render 运行 Core
2. 在其他地方运行 NapCat
3. 配置网络连接
4. 复杂且不稳定
```

**实用建议：**
- 如果是测试：可以试试
- 如果是正式使用：不推荐
- 建议直接用云服务器

### 3. 构建时间长

- 每次部署需要重新构建 Docker 镜像
- 构建时间：5-10分钟
- 修改代码后需要等待

---

## 🆘 常见问题

### Q1: 部署失败，显示 "Build Error"？

**A**: 检查以下内容：
1. Dockerfile 是否存在且正确
2. 依赖是否都能正常安装
3. 查看构建日志找出具体错误
4. 检查是否有语法错误

### Q2: 服务一直重启？

**A**:
1. 查看日志找出启动失败原因
2. 检查环境变量是否正确
3. 可能内存不足（免费版只有 512MB）
4. 尝试升级配置

### Q3: 机器人经常离线？

**A**:
- 免费版会自动休眠
- 升级到付费计划可解决
- 或设置外部 ping（不稳定）

### Q4: 如何查看完整日志？

**A**:
- 在服务页面点击 "Logs"
- 滚动查看历史日志
- 可以搜索关键词

### Q5: 可以部署多个服务吗？

**A**:
- 免费版可以部署多个服务
- 但每个都会独立休眠
- 总共 750 小时/月

---

## 📊 Render 适用场景

### ✅ 适合：

```
- 测试和学习 MaiBot
- 不需要 24/7 在线
- 愿意接受休眠限制
- 个人使用或小范围测试
- 不想花钱
```

### ❌ 不适合：

```
- 需要 24/7 稳定运行
- 大群使用（消息频繁）
- 正式产品部署
- 需要多容器应用（如 MaiBot）
- 对稳定性要求高
```

---

## 🎯 部署建议

### 如果你是新手想测试：

```
推荐流程：
1. 本地运行（免费、学习）
   ↓
2. Render 部署（免费、体验云端）
   ↓
3. 云服务器（稳定、完整功能）
```

### 如果你要正式使用：

```
推荐选择：
✅ 云服务器（阿里云/腾讯云）
   - 稳定 24/7 运行
   - 支持完整功能
   - 一键部署脚本

❌ 不推荐 Render
   - 会休眠
   - 多容器问题
   - 不稳定
```

---

## 🔄 从 Render 迁移

### 如果以后想迁移到云服务器：

```bash
# 1. 购买云服务器
# 2. 运行一键脚本
curl -fsSL https://raw.githubusercontent.com/hcx185381/maibot-my-fork/main/deploy.sh | sh

# 3. 配置环境变量（和 Render 一样）
# 4. 扫码登录

# 5. 删除 Render 服务（可选）
# 在 Render 控制台删除服务
```

---

## 📞 获取帮助

- **Render 文档**：https://render.com/docs
- **Render 支持邮箱**：support@render.com
- **MaiBot 文档**：https://docs.mai-mai.org

---

## 💡 总结

### Render 优势：
- ✅ 免费
- ✅ 不需要信用卡
- ✅ 配置简单
- ✅ 新手友好

### Render 劣势：
- ❌ 会休眠
- ❌ 不支持多容器
- ❌ MaiBot 无法完整运行
- ❌ 构建慢

### 我的建议：

**想学习/测试** → 可以试试 Render
**要正式使用** → 选择云服务器

---

**祝部署顺利！** 🎨
