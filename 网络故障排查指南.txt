================================================================================
                        MaiBot ç½‘ç»œæ•…éšœæ’æŸ¥æŒ‡å—
                            æ›´æ–°æ—¶é—´ï¼š2026-01-30
================================================================================

ç›®å½•
----
1. å¿«é€Ÿè¯Šæ–­ï¼ˆæ¨èï¼‰
2. å¸¸è§é—®é¢˜åŠè§£å†³æ–¹æ¡ˆ
3. ä¸åŒç½‘ç»œç¯å¢ƒé…ç½®
4. æ‰‹åŠ¨æ’æŸ¥æ­¥éª¤
5. é¢„é˜²æªæ–½


================================================================================
1. å¿«é€Ÿè¯Šæ–­ï¼ˆæ¨èï¼‰
================================================================================

ğŸš€ æœ€ç®€å•çš„æ–¹æ³•ï¼šåŒå‡»è¿è¡Œ "è¯Šæ–­å¹¶ä¿®å¤ç½‘ç»œé—®é¢˜.bat"

æ­¤è„šæœ¬ä¼šè‡ªåŠ¨ï¼š
âœ“ æ£€æŸ¥ Docker æ˜¯å¦è¿è¡Œ
âœ“ æ£€æŸ¥ä»£ç†è½¯ä»¶æ˜¯å¦è¿è¡Œ
âœ“ è‡ªåŠ¨æ£€æµ‹æœ€ä½³ä»£ç† IP
âœ“ æµ‹è¯•å®¹å™¨åˆ°ä»£ç†çš„è¿æ¥
âœ“ æµ‹è¯• AI API è¿æ¥
âœ“ è‡ªåŠ¨ä¿®å¤å¸¸è§é—®é¢˜

é€‚ç”¨äºä»»ä½•ç½‘ç»œç¯å¢ƒï¼ˆå®¶åº­ã€æ ¡å›­ã€å…¬å¸ç½‘ç»œï¼‰


================================================================================
2. å¸¸è§é—®é¢˜åŠè§£å†³æ–¹æ¡ˆ
================================================================================

é—®é¢˜ 1ï¼šMaiBot æ— æ³•å“åº”æ¶ˆæ¯ï¼ˆAI è¿æ¥å¤±è´¥ï¼‰
------------------------------------------------------------
ç—‡çŠ¶ï¼š
  - QQ å¯ä»¥ç™»å½•
  - ä½†æœºå™¨äººä¸å›å¤æ¶ˆæ¯
  - æ—¥å¿—æ˜¾ç¤º "API è¿æ¥å¤±è´¥" æˆ– "è¶…æ—¶"

åŸå› ï¼š
  Docker å®¹å™¨æ— æ³•é€šè¿‡ä»£ç†è®¿é—® AI API

è§£å†³æ–¹æ¡ˆï¼š
  æ–¹æ¡ˆ Aï¼ˆæ¨èï¼‰ï¼šè¿è¡Œ "è¯Šæ–­å¹¶ä¿®å¤ç½‘ç»œé—®é¢˜.bat"

  æ–¹æ¡ˆ Bï¼ˆæ‰‹åŠ¨ï¼‰ï¼š
  1. ç¡®è®¤ Clash Verge æ­£åœ¨è¿è¡Œ
  2. ç¡®è®¤ "å…è®¸å±€åŸŸç½‘è¿æ¥" å·²å¼€å¯
  3. ç¡®è®¤ HTTP ä»£ç†ç«¯å£æ˜¯ 7897
  4. è¿è¡Œï¼šdocker-compose restart


é—®é¢˜ 2ï¼šåˆ‡æ¢ç½‘ç»œåæ— æ³•è¿æ¥
------------------------------------------------------------
ç—‡çŠ¶ï¼š
  - åœ¨å®¶ç”¨ç½‘ç»œæ­£å¸¸
  - åˆ°å­¦æ ¡/å…¬å¸åæ— æ³•è¿æ¥

åŸå› ï¼š
  ä¸åŒç½‘ç»œçš„ IP æ®µä¸åŒï¼ŒDocker ç½‘å…³å¯èƒ½å˜åŒ–

è§£å†³æ–¹æ¡ˆï¼š
  1. è¿è¡Œ "è¯Šæ–­å¹¶ä¿®å¤ç½‘ç»œé—®é¢˜.bat" è‡ªåŠ¨é€‚é…æ–°ç½‘ç»œ
  2. æˆ–æ‰‹åŠ¨ä¿®æ”¹ docker-compose.yml ä¸­çš„ä»£ç† IP

  å¸¸ç”¨çš„ä»£ç† IPï¼š
  - WSL ç½‘å…³ï¼š172.30.240.1ï¼ˆæœ€ç¨³å®šï¼Œæ¨èï¼‰
  - Docker ç½‘å…³ï¼š172.19.0.1ï¼ˆå¯èƒ½å˜åŒ–ï¼‰
  - WLAN IPï¼šå¦‚ 192.168.0.111ï¼ˆéšç½‘ç»œå˜åŒ–ï¼‰


é—®é¢˜ 3ï¼šæ ¡å›­ç½‘æ— æ³•è¿æ¥
------------------------------------------------------------
ç—‡çŠ¶ï¼š
  - åœ¨æ ¡å›­ç½‘ç¯å¢ƒä¸‹å®¹å™¨æ— æ³•è¿æ¥ä»£ç†
  - æ˜¾ç¤º "Connection refused"

åŸå› ï¼š
  æ ¡å›­ç½‘å¯èƒ½æœ‰ä¸¥æ ¼çš„ç½‘ç»œéš”ç¦»ç­–ç•¥

è§£å†³æ–¹æ¡ˆï¼š
  æ–¹æ¡ˆ Aï¼šä½¿ç”¨ WSL ç½‘å…³ï¼ˆæ¨èï¼‰
  docker-compose.yml ä¸­è®¾ç½®ï¼š
  HTTP_PROXY=http://172.30.240.1:7897
  HTTPS_PROXY=http://172.30.240.1:7897

  æ–¹æ¡ˆ Bï¼šä½¿ç”¨å®¿ä¸»æœº WLAN IP
  1. æŸ¥çœ‹ä½ çš„ WLAN IPï¼šipconfig
  2. ä¿®æ”¹ docker-compose.ymlï¼š
     HTTP_PROXY=http://ä½ çš„WLAN IP:7897
     HTTPS_PROXY=http://ä½ çš„WLAN IP:7897
  3. é‡å¯å®¹å™¨

  æ–¹æ¡ˆ Cï¼šé…ç½® Clash ç›‘å¬æ‰€æœ‰æ¥å£
  1. æ‰“å¼€ Clash é…ç½®æ–‡ä»¶
  2. è®¾ç½®ï¼šallow-lan: true
  3. è®¾ç½®ï¼šbind-address: "*"
  4. é‡å¯ Clash


é—®é¢˜ 4ï¼šä»£ç†è½¯ä»¶è¢«å®¹å™¨æ‹’ç»è¿æ¥
------------------------------------------------------------
ç—‡çŠ¶ï¼š
  - æ—¥å¿—æ˜¾ç¤º "Connection refused" æˆ– "Connection reset"
  - netstat æ˜¾ç¤ºä»£ç†åœ¨ 127.0.0.1:7897 è€Œä¸æ˜¯ 0.0.0.0:7897

åŸå› ï¼š
  ä»£ç†è½¯ä»¶åªç›‘å¬æœ¬åœ°å›ç¯åœ°å€ï¼Œä¸æ¥å—å¤–éƒ¨è¿æ¥

è§£å†³æ–¹æ¡ˆï¼š
  1. æ‰“å¼€ Clash Verge
  2. è¿›å…¥è®¾ç½® â†’ ä¿®æ”¹ "å…è®¸å±€åŸŸç½‘è¿æ¥" ä¸ºå¼€å¯
  3. ç¡®è®¤ "ç«¯å£" æ˜¯ 7897
  4. é‡å¯ Clash
  5. éªŒè¯ï¼šnetstat -ano | findstr ":7897"
     åº”è¯¥çœ‹åˆ°ï¼šTCP    0.0.0.0:7897    LISTENING


é—®é¢˜ 5ï¼šDocker ç½‘å…³ IP å˜åŒ–
------------------------------------------------------------
ç—‡çŠ¶ï¼š
  - åŸæœ¬æ­£å¸¸çš„ä»£ç†çªç„¶æ— æ³•è¿æ¥
  - é”™è¯¯ï¼šNo route to host

åŸå› ï¼š
  Docker é‡å»ºç½‘ç»œåç½‘å…³ IP å˜åŒ–

è§£å†³æ–¹æ¡ˆï¼š
  ä½¿ç”¨ç¨³å®šçš„ WSL ç½‘å…³ IPï¼š172.30.240.1
  ä¿®æ”¹ docker-compose.ymlï¼š
  HTTP_PROXY=http://172.30.240.1:7897
  HTTPS_PROXY=http://172.30.240.1:7897

  ç„¶åé‡å¯ï¼š
  docker-compose down && docker-compose up -d


================================================================================
3. ä¸åŒç½‘ç»œç¯å¢ƒé…ç½®
================================================================================

å®¶åº­ç½‘ç»œï¼ˆæ¨èé…ç½®ï¼‰
------------------------------------------------------------
ä»£ç† IPï¼š172.30.240.1 (WSL ç½‘å…³)
é…ç½®ï¼š
  HTTP_PROXY=http://172.30.240.1:7897
  HTTPS_PROXY=http://172.30.240.1:7897

ç‰¹ç‚¹ï¼š
  âœ… ç¨³å®šï¼Œä¸ä¼šå› ç½‘ç»œåˆ‡æ¢è€Œå˜åŒ–
  âœ… é€‚ç”¨äºå¤§å¤šæ•°å®¶åº­ç½‘ç»œ


æ ¡å›­ç½‘ï¼ˆå¯èƒ½æœ‰ç½‘ç»œéš”ç¦»ï¼‰
------------------------------------------------------------
ä»£ç† IPï¼š172.30.240.1 (é¦–é€‰) æˆ– ä½ çš„ WLAN IP
é…ç½®ï¼š
  # é¦–é€‰ï¼šWSL ç½‘å…³
  HTTP_PROXY=http://172.30.240.1:7897
  HTTPS_PROXY=http://172.30.240.1:7897

  # å¤‡é€‰ï¼šWLAN IPï¼ˆéœ€è¦æ ¹æ®å®é™…æƒ…å†µä¿®æ”¹ï¼‰
  # 1. è¿è¡Œ ipconfig æŸ¥çœ‹ WLAN IPv4 åœ°å€
  # 2. å‡è®¾æ˜¯ 10.20.30.40
  HTTP_PROXY=http://10.20.30.40:7897
  HTTPS_PROXY=http://10.20.30.40:7897

ç‰¹ç‚¹ï¼š
  âš ï¸  å¯èƒ½éœ€è¦é¢å¤–é…ç½® Clash
  âš ï¸  WLAN IP å¯èƒ½éšç½‘ç»œå˜åŒ–


å…¬å¸ç½‘ç»œï¼ˆå¯èƒ½æœ‰é˜²ç«å¢™ï¼‰
------------------------------------------------------------
ä»£ç† IPï¼š172.30.240.1 æˆ–å…¬å¸å†…ç½‘ IP
é…ç½®ï¼š
  HTTP_PROXY=http://172.30.240.1:7897
  HTTPS_PROXY=http://172.30.240.1:7897

æ³¨æ„äº‹é¡¹ï¼š
  - ç¡®è®¤å…¬å¸å…è®¸ä½¿ç”¨ä»£ç†
  - å¯èƒ½éœ€è¦é…ç½®ä»£ç†ç™½åå•
  - æŸäº›ç«¯å£å¯èƒ½è¢«å°é”


ç§»åŠ¨çƒ­ç‚¹ / è®¿é—®çƒ­ç‚¹
------------------------------------------------------------
ä»£ç† IPï¼š172.30.240.1ï¼ˆé€šå¸¸ä»ç„¶æœ‰æ•ˆï¼‰
é…ç½®ï¼š
  HTTP_PROXY=http://172.30.240.1:7897
  HTTPS_PROXY=http://172.30.240.1:7897

ç‰¹ç‚¹ï¼š
  âœ… WSL ç½‘å…³é€šå¸¸ä¸å—å½±å“
  âš ï¸  å¦‚æœä¸è¡Œï¼Œå°è¯•ä½¿ç”¨ WLAN IP


================================================================================
4. æ‰‹åŠ¨æ’æŸ¥æ­¥éª¤
================================================================================

å¦‚æœè‡ªåŠ¨è„šæœ¬æ— æ³•è§£å†³é—®é¢˜ï¼ŒæŒ‰ä»¥ä¸‹æ­¥éª¤æ‰‹åŠ¨æ’æŸ¥ï¼š

æ­¥éª¤ 1ï¼šæ£€æŸ¥ Docker
------------------------------------------------------------
docker ps
åº”è¯¥çœ‹åˆ° 4 ä¸ªå®¹å™¨ï¼š
- maim-bot-core
- maim-bot-napcat
- maim-bot-adapters
- sqlite-web

å¦‚æœå¤±è´¥ï¼š
- å¯åŠ¨ Docker Desktop
- ç­‰å¾… Docker å®Œå…¨å¯åŠ¨ï¼ˆçº¦ 30 ç§’ï¼‰


æ­¥éª¤ 2ï¼šæ£€æŸ¥ä»£ç†è½¯ä»¶
------------------------------------------------------------
netstat -ano | findstr ":7897"
åº”è¯¥çœ‹åˆ°ï¼š
TCP    0.0.0.0:7897    LISTENING    [PID]

å¦‚æœä¸æ˜¯ 0.0.0.0 è€Œæ˜¯ 127.0.0.1ï¼š
- æ‰“å¼€ Clash Verge
- å¼€å¯ "å…è®¸å±€åŸŸç½‘è¿æ¥"
- é‡å¯ Clash


æ­¥éª¤ 3ï¼šæ£€æŸ¥ Docker ç½‘ç»œé…ç½®
------------------------------------------------------------
docker network inspect maibot_maim_bot --format "{{json .IPAM.Config}}"
åº”è¯¥çœ‹åˆ°ï¼š
[{"Subnet":"172.19.0.0/16","Gateway":"172.19.0.1"}]

è®°ä¸‹ Gateway IPï¼ˆè¿™é‡Œç¤ºä¾‹æ˜¯ 172.19.0.1ï¼‰


æ­¥éª¤ 4ï¼šæµ‹è¯•å®¹å™¨åˆ°å®¿ä¸»æœºçš„è¿æ¥
------------------------------------------------------------
# æµ‹è¯• WSL ç½‘å…³
docker exec maim-bot-core python -c "import socket; s=socket.socket(); s.settimeout(3); r=s.connect_ex(('172.30.240.1', 7897)); s.close(); print('OK' if r==0 else 'FAILED')"

# æµ‹è¯• Docker ç½‘å…³
docker exec maim-bot-core python -c "import socket; s=socket.socket(); s.settimeout(3); r=s.connect_ex(('172.19.0.1', 7897)); s.close(); print('OK' if r==0 else 'FAILED')"

# æµ‹è¯•ä½ çš„ WLAN IPï¼ˆæ›¿æ¢ä¸ºå®é™… IPï¼‰
docker exec maim-bot-core python -c "import socket; s=socket.socket(); s.settimeout(3); r=s.connect_ex(('192.168.0.111', 7897)); s.close(); print('OK' if r==0 else 'FAILED')"

é€‰æ‹©å“ªä¸ªè¿”å› OK å°±ç”¨å“ªä¸ª IP


æ­¥éª¤ 5ï¼šæµ‹è¯•ä»£ç†åˆ° AI API çš„è¿æ¥
------------------------------------------------------------
docker exec maim-bot-core python -c "import os, urllib.request; os.environ['HTTPS_PROXY']='http://172.30.240.1:7897'; urllib.request.urlopen('https://open.bigmodel.cn', timeout=10); print('Success')"

å¦‚æœå¤±è´¥ï¼š
- æ£€æŸ¥ä»£ç†æœ¬èº«æ˜¯å¦å·¥ä½œ
- æµè§ˆå™¨æµ‹è¯•ï¼šhttps://open.bigmodel.cn
- æ£€æŸ¥ä»£ç†æ˜¯å¦å…è®¸è®¿é—®è¯¥åŸŸå


æ­¥éª¤ 6ï¼šæ£€æŸ¥ MaiBot æ—¥å¿—
------------------------------------------------------------
docker logs maim-bot-core --tail 50
æŸ¥çœ‹æ˜¯å¦æœ‰ï¼š
- API è¿æ¥é”™è¯¯
- è¶…æ—¶é”™è¯¯
- ä»£ç†ç›¸å…³é”™è¯¯

å¸¸è§é”™è¯¯ï¼š
- "Connection refused"ï¼šä»£ç†é…ç½®é—®é¢˜
- "Timeout"ï¼šç½‘ç»œæˆ– API é—®é¢˜
- "SSL error"ï¼šä»£ç† SSL é…ç½®é—®é¢˜


æ­¥éª¤ 7ï¼šä¿®æ”¹ docker-compose.yml
------------------------------------------------------------
æ‰¾åˆ°è¿™äº›è¡Œï¼š
environment:
  - HTTP_PROXY=http://XXX.XXX.XXX.XXX:7897
  - HTTPS_PROXY=http://XXX.XXX.XXX.XXX:7897

å°† XXX.XXX.XXX.XXX æ›¿æ¢ä¸ºæ­¥éª¤ 4 ä¸­æµ‹è¯•æˆåŠŸçš„ IP


æ­¥éª¤ 8ï¼šé‡å¯å®¹å™¨
------------------------------------------------------------
docker-compose down
docker-compose up -d

ç­‰å¾… 10 ç§’è®©å®¹å™¨å®Œå…¨å¯åŠ¨


æ­¥éª¤ 9ï¼šéªŒè¯ä¿®å¤
------------------------------------------------------------
docker logs maim-bot-core --tail 20
åº”è¯¥çœ‹åˆ°ï¼š
- WebSocket å·²è¿æ¥
- æ²¡æœ‰è¿æ¥é”™è¯¯

ç„¶ååœ¨ QQ ä¸­å‘é€æµ‹è¯•æ¶ˆæ¯


================================================================================
5. é¢„é˜²æªæ–½
================================================================================

âœ… æœ€ä½³å®è·µ
------------------------------------------------------------
1. å§‹ç»ˆä½¿ç”¨ WSL ç½‘å…³ IPï¼š172.30.240.1
   - ä¼˜ç‚¹ï¼šç¨³å®šï¼Œä¸éšç½‘ç»œå˜åŒ–
   - é€‚ç”¨äºæ‰€æœ‰ç½‘ç»œç¯å¢ƒ

2. ä¿æŒ Clash è®¾ç½®ï¼š
   - å…è®¸å±€åŸŸç½‘è¿æ¥ï¼šå¼€å¯
   - HTTP ç«¯å£ï¼š7897
   - Mixed ç«¯å£ï¼š7890

3. å®šæœŸæ£€æŸ¥ï¼š
   - æ¯æ¬¡åˆ‡æ¢ç½‘ç»œåè¿è¡Œè¯Šæ–­è„šæœ¬
   - æŸ¥çœ‹ Docker æ—¥å¿—ç¡®è®¤æ— é”™è¯¯

4. å¤‡ä»½é…ç½®ï¼š
   - ä¿å­˜å·¥ä½œæ­£å¸¸çš„ docker-compose.yml
   - è®°å½•ä¸‹æœ‰æ•ˆçš„ä»£ç† IP


âš ï¸ é¿å…çš„é”™è¯¯
------------------------------------------------------------
âŒ ä¸è¦ä½¿ç”¨ 127.0.0.1 æˆ– localhost
   - å®¹å™¨å†…éƒ¨æ— æ³•è®¿é—®å®¿ä¸»æœºçš„ 127.0.0.1

âŒ ä¸è¦ä½¿ç”¨ host.docker.internal
   - Windows Docker Desktop å¯èƒ½æ— æ³•è§£æ

âŒ ä¸è¦é¢‘ç¹æ›´æ¢ä»£ç† IP
   - é€‰æ‹©ä¸€ä¸ªç¨³å®šçš„ IPï¼ˆæ¨è 172.30.240.1ï¼‰

âŒ ä¸è¦å¿½ç•¥é˜²ç«å¢™
   - Windows é˜²ç«å¢™å¯èƒ½é˜»æ­¢å®¹å™¨è®¿é—®


ğŸ“ å¿«é€Ÿå‚è€ƒ
------------------------------------------------------------
å¸¸ç”¨å‘½ä»¤ï¼š
# æŸ¥çœ‹å®¹å™¨çŠ¶æ€
docker ps

# æŸ¥çœ‹æ—¥å¿—
docker logs maim-bot-core --tail 50

# é‡å¯å®¹å™¨
docker-compose restart

# å®Œå…¨é‡å¯
docker-compose down && docker-compose up -d

# æµ‹è¯•ä»£ç†è¿æ¥
netstat -ano | findstr ":7897"

# æŸ¥çœ‹ç½‘ç»œé…ç½®
ipconfig

# æŸ¥çœ‹ Docker ç½‘ç»œ
docker network ls
docker network inspect maibot_maim_bot


é‡è¦ IP åœ°å€ï¼š
- WSL ç½‘å…³ï¼š172.30.240.1ï¼ˆæ¨èï¼‰
- Docker ç½‘å…³ï¼š172.19.0.1ï¼ˆå¯èƒ½å˜åŒ–ï¼‰
- ä»£ç†ç«¯å£ï¼š7897

ç®¡ç†ç•Œé¢ï¼š
- MaiBot WebUIï¼šhttp://localhost:8001
- NapCat WebUIï¼šhttp://localhost:6099


================================================================================
æ›´æ–°è®°å½•
================================================================================

2026-01-30ï¼š
  âœ… æ·»åŠ è‡ªåŠ¨è¯Šæ–­è„šæœ¬
  âœ… æ·»åŠ  WSL ç½‘å…³æ–¹æ¡ˆï¼ˆ172.30.240.1ï¼‰
  âœ… æ·»åŠ æ ¡å›­ç½‘ç¯å¢ƒé…ç½®
  âœ… æ·»åŠ å®Œæ•´çš„æ‰‹åŠ¨æ’æŸ¥æ­¥éª¤
  âœ… æ·»åŠ é¢„é˜²æªæ–½å’Œæœ€ä½³å®è·µ


================================================================================
è”ç³»ä¸æ”¯æŒ
================================================================================

å¦‚æœä»¥ä¸Šæ–¹æ³•éƒ½æ— æ³•è§£å†³é—®é¢˜ï¼š

1. æŸ¥çœ‹å®Œæ•´æ—¥å¿—ï¼š
   docker logs maim-bot-core > logs.txt

2. è®¿é—®é¡¹ç›®æ–‡æ¡£ï¼š
   https://docs.mai-mai.org

3. GitHub Issuesï¼š
   https://github.com/mlikiowa/maim-bot-action-bilibili-help-list/issues

4. è®°å½•ä»¥ä¸‹ä¿¡æ¯ä»¥ä¾¿æ±‚åŠ©ï¼š
   - ç½‘ç»œç¯å¢ƒï¼ˆå®¶åº­/æ ¡å›­/å…¬å¸ï¼‰
   - é”™è¯¯ä¿¡æ¯æˆªå›¾
   - docker-compose.yml é…ç½®
   - è¯Šæ–­è„šæœ¬è¾“å‡º

================================================================================
