# 🔄 模型配置一键切换工具使用说明

> **最后更新**: 2026-02-02
> **工具版本**: v1.0

---

## 🎯 工具说明

这套工具可以让你**一键切换**MaiBot的模型配置：
- 🆓 **全免费模型** - 硅基流动免费模型（¥0/月）
- ⭐ **DeepSeek官方** - DeepSeek官网API（性能最优）

---

## 📁 工具文件

| 文件名 | 功能 | 使用场景 |
|-------|------|---------|
| **切换到全免费模型.bat** | 切换到硅基流动全免费模型 | 想要零成本使用 |
| **切换回DeepSeek官网.bat** | 切换回DeepSeek官方API | 追求最佳性能 |
| **查看当前模型配置.bat** | 查看当前配置状态 | 不确定当前配置时 |

---

## 🚀 使用方法

### 方法1：双击运行（推荐）

1. 找到对应的 `.bat` 文件
2. 双击运行
3. 等待自动切换完成
4. 在QQ群里测试机器人

### 方法2：右键管理员运行

如果遇到权限问题：

1. 右键点击 `.bat` 文件
2. 选择"以管理员身份运行"
3. 等待完成

---

## 📊 切换选项对比

### 选项1：切换到全免费模型 🆓

**运行文件**: `切换到全免费模型.bat`

**配置内容**:
- Qwen/Qwen2.5-7B-Instruct（日常聊天）
- DeepSeek-R1-Distill-Qwen-7B（复杂推理）
- PaddlePaddle/PaddleOCR-VL（OCR识别）

**优势**:
- 💰 **¥0/月 - 完全免费**
- 🚀 性能达到DeepSeek-V3的75%
- ⚡ 配置简单，无限制使用

**适合场景**:
- ✅ 个人学习、测试
- ✅ 小型项目（<500条/天）
- ✅ 预算有限
- ✅ 零成本体验AI

---

### 选项2：切换回DeepSeek官网 ⭐

**运行文件**: `切换回DeepSeek官网.bat`

**配置内容**:
- deepseek-chat（所有任务）
- deepseek-vl（视觉理解）

**优势**:
- 💎 **100%性能**（最强）
- 🏢 **官方源**（最稳定）
- 💵 **长期最便宜**（有缓存机制）

**适合场景**:
- ✅ 长期稳定使用
- ✅ 生产环境
- ✅ 追求最佳性能
- ✅ 商业项目

**费用说明**:
- 缓存命中：¥0.2/百万tokens（便宜10倍！）
- 缓存未命中：¥2/百万tokens
- 输出：¥3/百万tokens
- 月费用：¥8-26（1000万tokens）

---

### 选项3：查看当前配置 🔍

**运行文件**: `查看当前模型配置.bat`

**显示内容**:
- 当前使用的配置类型
- 使用的模型列表
- 费用和性能说明
- 容器运行状态
- 最近日志

---

## 📝 切换流程

### 完整的切换步骤

```
┌─────────────────────────────────────────┐
│  1. 双击运行 .bat 文件                  │
│     ↓                                    │
│  2. 自动备份当前配置                     │
│     (保存为 model_config.toml.last)      │
│     ↓                                    │
│  3. 应用新配置                           │
│     (复制对应的配置文件)                 │
│     ↓                                    │
│  4. 重启容器                             │
│     (docker-compose restart core)        │
│     ↓                                    │
│  5. 显示状态和日志                       │
│     (容器状态 + 最近日志)                │
│     ↓                                    │
│  6. 测试机器人                           │
│     (在QQ群里发消息测试)                 │
└─────────────────────────────────────────┘
```

---

## ✅ 切换成功标志

### 看到这些信息说明切换成功

```
╔══════════════════════════════════════════════════╗
║              ✅ 切换成功！                       ║
╚══════════════════════════════════════════════════╝

当前配置：[配置类型]
使用模型：
  • [模型1]
  • [模型2]

等待10秒后检查状态...
```

### 容器状态检查

```
容器状态检查：
────────────────────────────────────────────
NAMES              STATUS          PORTS
maim-bot-core      Up 2 minutes    0.0.0.0:22400...
```

状态显示 `Up X minutes` 说明运行正常 ✅

---

## 🆘 常见问题

### Q1: 切换后机器人不回复？

**解决步骤**:
1. 运行 `查看当前模型配置.bat` 检查配置
2. 查看日志中的错误信息
3. 确认API Key是否正确
4. 尝试重启容器：
   ```bash
   docker-compose restart core
   ```

---

### Q2: 提示"找不到配置文件"？

**原因**: 配置文件缺失或路径错误

**解决**:
1. 确认当前在项目根目录
2. 检查以下文件是否存在：
   - `docker-config\mmc\model_config_siliconflow_free_only.toml`
   - `docker-config\mmc\model_config_deepseek_official.toml`
3. 如果文件不存在，重新运行配置脚本

---

### Q3: Windows提示"无法识别docker命令"？

**原因**: Docker未启动或未在PATH中

**解决**:
1. 确认Docker Desktop正在运行
2. 重启Docker Desktop
3. 以管理员身份运行.bat文件

---

### Q4: 切换需要多长时间？

**正常情况**: 约30-60秒

**时间分配**:
- 备份配置：2秒
- 应用配置：2秒
- 重启容器：20-30秒
- 检查状态：5秒
- 总计：约30秒

---

### Q5: 可以频繁切换吗？

**答**: 可以！✅

**注意事项**:
- 每次切换会备份当前配置
- 切换时会重启容器（约30秒）
- 建议测试后再决定使用哪种配置
- 可以随时切换回来

---

## 📊 配置文件说明

### 自动创建的备份文件

切换过程中会自动创建以下备份：

| 备份文件 | 内容 | 创建时机 |
|---------|------|---------|
| `model_config.toml.last` | 切换前的配置 | 每次切换时 |
| `model_config.toml.free` | 全免费配置备份 | 切换到付费时 |
| `model_config.toml.backup` | 手动备份 | 用户手动创建 |

**恢复方法**:
```bash
# 从备份恢复
copy docker-config\mmc\model_config.toml.last docker-config\mmc\model_config.toml
docker-compose restart core
```

---

## 💡 使用建议

### 新手建议

1. **先试用全免费模型** 🆓
   - 零成本体验
   - 性能足够日常使用
   - 不满意随时切换

2. **测试1-2周后评估**
   - 记录使用体验
   - 评估是否需要更好的性能
   - 考虑实际需求

3. **根据需求选择**
   - 够用 → 继续用免费模型
   - 不够用 → 切换到DeepSeek官网

### 老手建议

1. **日常用免费，重要用付费**
   - 创建自定义配置
   - 不同任务用不同模型
   - 优化成本和性能

2. **定期检查费用**
   - 查看API使用量
   - 评估实际费用
   - 调整配置策略

---

## 🔧 高级用法

### 手动编辑配置文件

如果你了解配置格式，可以直接编辑：

1. 打开 `docker-config\mmc\model_config.toml`
2. 修改任务配置中的 `model_list`
3. 保存并重启容器

### 创建自定义配置

1. 复制现有配置文件
2. 修改模型配置
3. 保存为新的配置文件
4. 修改bat文件引用新配置

---

## 📚 相关文档

- **硅基流动全免费模型指南.md** - 详细使用教程
- **硅基流动切换教程.md** - 完整切换教程
- **三种方案快速对比.md** - 方案对比分析
- **当前API配置状态.md** - 当前配置说明

---

## 🎉 总结

### 核心优势

- ✅ **一键切换** - 双击即可完成
- ✅ **自动备份** - 每次切换自动备份
- ✅ **状态显示** - 清晰的切换状态
- ✅ **安全可靠** - 不会丢失配置

### 快速开始

1. **想免费使用？**
   → 双击 `切换到全免费模型.bat`

2. **想要性能？**
   → 双击 `切换回DeepSeek官网.bat`

3. **不确定当前配置？**
   → 双击 `查看当前模型配置.bat`

---

## 📞 支持

遇到问题？
1. 查看本文档的"常见问题"部分
2. 检查容器日志：`docker logs maim-bot-core`
3. 参考相关文档

---

**工具版本**: v1.0
**创建时间**: 2026-02-02
**维护者**: hcx185381
**更新日志**:
- v1.0 (2026-02-02): 初始版本
  - 创建一键切换工具
  - 支持全免费模型和DeepSeek官网切换
  - 添加配置状态查看功能
